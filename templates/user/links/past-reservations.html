<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Past Reservations</title>
</head>
<body>
    {% if formatted_past_reserved_spots %}
    {% for spot in formatted_past_reserved_spots %}
        <div>
            Reserved Spot ID: {{ spot.reserved_spot.reserved_spot_id }}<br>
            Parking Time: {{ spot.parking_time }}<br>
            Leaving Time: {{ spot.leaving_time }}<br>
            Reserve by : {{ spot.reserved_spot.user_detail.name }}<br>
            Email : {{ spot.reserved_spot.user_detail.email }}, {{ spot.reserved_spot.user_detail.restrictUser }}<br>
            Address : {{ spot.reserved_spot.user_detail.address_detail.address }}<br>
            Phone : {{ spot.reserved_spot.phone }}<br>
            Spot ID: {{ spot.reserved_spot.spot_detail.spot_id }}<br>
            Lot Name: {{ spot.reserved_spot.spot_detail.lot_detail.lot_name }}<br>
            Spot price per hour : {{ spot.reserved_spot.spot_detail.lot_detail.price_per_hr }}<br>
            Lot Location : {{ spot.reserved_spot.spot_detail.lot_detail.geographical_detail.location }}, {{ spot.reserved_spot.spot_detail.lot_detail.geographical_detail.country }}<br>
            <br>
            <button class="book-again" data-lot-id="{{ spot.reserved_spot.spot_detail.lot_detail.lot_id }}">Book a Spot Again</button>
            <br>
        </div>
    {% endfor %}
    {% else %}
        <div style="color: #888; font-style: italic;">{{ message }}</div>
    {% endif %}

    <div class="pagination-container">
        <ul class="pagination">
            {% if pagination.has_prev %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('view-reserved-spots.activeReservations', page=pagination.prev_num) }}">Previous</a>
                </li>
            {% else %}
                <li class="page-item disabled">
                    <span class="page-link">Previous</span>
                </li>
            {% endif %}

            {% if pagination.has_next %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('view-reserved-spots.activeReservations', page=pagination.next_num) }}">Next</a>
                </li>
            {% else %}
                <li class="page-item disabled">
                    <span class="page-link">Next</span>
                </li>
            {% endif %}
        </ul>
    </div>
    <script>
        Array.from(document.getElementsByClassName('book-again')).forEach(btn => {
            btn.addEventListener('click', () => {
                const lotId = btn.getAttribute('data-lot-id');
                window.location.href = `/TruLotParking/role/userDashboard/bookOneSpot?lot_id=${lotId}`;
            });
        });
    </script>
</body>
</html>